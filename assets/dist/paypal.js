(()=>{"use strict";function e(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t={validated:!0,message:null},r=!1,n=!1,i="",s=document.querySelectorAll("#tripzzy-checkout-form [required]");s.length>0&&s.forEach((function(t){var s=t.value,o=t.closest(".tripzzy-form-field").getAttribute("title");t.classList.remove("has-error"),s||(n=!0,i+="* "+o+" is required field. </br />",e||(t.classList.add("has-error"),r||(r=!0,t.focus())))}));var o=document.querySelectorAll("#tripzzy-checkout-form input[type=email]");return o.length>0&&o.forEach((function(t){var s=t.value,o=t.closest(".tripzzy-form-field").getAttribute("title");t.classList.remove("has-error"),s&&!s.match(/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/)&&(n=!0,i+="* "+o+" is not valid. </br />",e||(t.classList.add("has-error"),r||(r=!0,t.focus())))})),n&&(t.validated=!1,t.message=i),t}function t(e){var t=document.getElementById("tripzzy-checkout-form-response-msg"),r=document.getElementById("tripzzy-checkout-form-response-title"),n=document.getElementById("tripzzy-checkout-form-response");e?(t.classList.add("tripzzy-response-msg","tripzzy-error"),r.innerHTML="Error",n.innerHTML=e):(t.classList.remove("tripzzy-response-msg","tripzzy-error"),r.innerHTML="",n.innerHTML="")}function r(){var r=document.getElementById("tripzzy-checkout-form-response-msg"),n=document.getElementById("tripzzy-checkout-form-response-title"),i=document.getElementById("tripzzy-checkout-form-response"),s=document.getElementById("tripzzy-payment-button");try{s.innerHTML="",s.classList.add("tripzzy-is-processing"),t();var o=document.getElementById("tripzzy-payment-details"),c=document.getElementById("tripzzy-checkout-form"),a=s.getAttribute("data-total");paypal.Buttons({onInit:function(r,n){n.disable(),e(!0).validated&&n.enable(),document.querySelectorAll("#tripzzy-checkout-form [required]").forEach((function(r){r.addEventListener("change",(function(r){var i=e();t(i.message),n.disable(),i.validated&&n.enable()}))}))},onClick:function(){t(e().message)},createOrder:function(e,r){return t(),r.order.create({purchase_units:[{amount:{value:null!=a?a:0},description:tripzzy.payment_description,payment_instruction:{soft_descriptor:"3D_SECURE",secure_payment:{required:!0}}}],application_context:{shipping_preference:"NO_SHIPPING"}})},onApprove:function(e,t){return t.order.capture().then((function(e){o.value=JSON.stringify(e),c.submit()}))},onCancel:function(e){r.classList.add("tripzzy-response-msg","tripzzy-error"),n.innerHTML="Cancelled",i.innerHTML="You have cancelled your payment."},onError:function(e){var t=e.message.match(/\{[\s\S]*\}/)[0];if(t){var o=JSON.parse(t);r.classList.add("tripzzy-response-msg","tripzzy-error"),n.innerHTML=o.name,i.innerHTML=o.details[0].description}s.classList.remove("tripzzy-is-processing")}}).render("#tripzzy-payment-button").then((function(e){return s.classList.remove("tripzzy-is-processing")}))}catch(e){r.classList.add("tripzzy-response-msg","tripzzy-error"),n.innerHTML="Error",i.innerHTML=e.message,s.classList.remove("tripzzy-is-processing")}}window.wp.i18n,r(),document.addEventListener("click",(function(e){e.target===document.querySelector("#tripzzy-payment-mode-paypal_payment")&&r()}))})();